<project name="as-php-talk" basedir="." default="swc">

	<!-- Set up a prefix for all environment variables. -->
	<property environment="env."/>
	
	<fail unless="env.FLEX_HOME" message="FLEX_HOME needs to be defined as an environment variable or in the Ant build." />
	<!-- Copy Flex SDK location from environment variable. This can be set manually instead. -->
	<property name="FLEX_HOME" value="${env.FLEX_HOME}" />
	<property file="build.properties"/>
	
	<target name="clean" description="Remove folders generated by the build.">
		<echo>[clean] Removing generating folders.</echo>
		<delete dir="${output.dir}" quiet="true" includeEmptyDirs="true"/>
	</target>
	
	<target name="swc" depends="clean" description="Compile AS3 code into a SWC.">
		<echo>[swc] Building SWC</echo>
		<echo>[swc] Using Flex SDK at: ${FLEX_HOME}</echo>
		<mkdir dir="${output.dir}"/>
			
		<java jar="${FLEX_HOME}/lib/compc.jar" dir="." fork="true" failonerror="true">
			<arg value="+flexlib=${FLEX_HOME}/frameworks" />
			<arg value="-incremental=true" />
				
			<arg value="-source-path+=${src.dir}" />
			
			<!-- Include all classes in this path. -->
			<arg value="-include-sources=${src.dir}/${package.dir}" />
			
			<!-- Link in classes from swc library (only those used). -->
			<!--<arg value="-library-path+=${libs.dir}" />-->
			
			<arg value="-output=${output.swc}" />
		</java>
	</target>
</project>
